Recent activity in Portfoliyo:

{# 1. Requested Posts - parents then teachers, internally ordered by time #}

{# 1.1 Single Posts #}

{% for village in villages %}
  {% include "notifications/activity/_village_posts.txt" %}
{% endfor %}

{# 1.2 Bulk Post #}
{# only treat as bulk if it went to more than one of my villages #}

{% for combo_of_villages in combos_of_villages %}
  {% include "notifications/activity/_bulk_post.txt" %}
{% endfor %}

{# 2. Requested Activity #}

{% for student in students %}
  {% include "notifications/activity/_new_parent.txt" %}
{% endfor %}
{% if recipient.notify_added_to_village %}
  {% include "notifications/activity/_added_to_villages.txt" %}
{% endif %}
{% if recipient.notify_joined_my_village %}
  {% include "notifications/activity/_new_teachers.txt" %}
{% endif %}


{# 3. Non-Requested Posts + Activity - ordered by time #}

Other activity:

{% for village in villages %}
  {% include "notifications/activity/_village_posts_nonrequested.txt" %}
{% endfor %}
{# this should loop over each combination of villages for EACH posting teacher #}
{% for combo_of_villages_per_teacher in combos_of_villages_per_teacher %}
  {% include "notifications/activity/_bulk_post_nonrequested.txt" %}
{% endfor %}
{% for student in students %}
  {% include "notifications/activity/_new_parent.txt" %}
{% endfor %}
{% if not recipient.notify_added_to_village %}
  {% include "notifications/activity/_added_to_villages_nonrequested.txt" %}
{% endif %}
{% if not recipient.notify_joined_my_village %}
  {% include "notifications/activity/_new_teachers.txt" %}
{% endif %}


--
Don't want email notifications? Edit your profile: {{ profile_url }}
