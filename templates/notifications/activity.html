<h1>Recent activity in Portfoliyo:</h1>

{# 1. Requested Posts - parents then teachers, internally ordered by time #}

{# 1.1 Single Posts #}

{% for village in villages %}
  {% include "notifications/activity/_village_posts.html" %}
{% endfor %}

{# 1.2 Bulk Post #}
{# only treat as bulk if it went to more than one of my villages #}

{% for combo_of_villages in combos_of_villages %}
  {% include "notifications/activity/_bulk_post.html" %}
{% endfor %}

{# 2. Requested Activity #}

<ul class="requested">
  {% if recipient.notify_new_parent %}
    {% include "notifications/activity/_new_parents.html" %}
  {% endif %}
  {% if recipient.notify_added_to_village %}
    {% include "notifications/activity/_added_to_villages.html" %}
  {% endif %}
  {% if recipient.notify_joined_my_village %}
    {% include "notifications/activity/_new_teachers.html" %}
  {% endif %}
</ul>

{# 3. Non-Requested Posts + Activity - ordered by time #}

<ul class="nonrequested">
  {% for village in villages %}
    {% include "notifications/activity/_village_posts_nonrequested.html" %}
  {% endfor %}
  {# this should loop over each combination of villages for EACH posting teacher #}
  {% for combo_of_villages_per_teacher in combos_of_villages_per_teacher %}
    {% include "notifications/activity/_bulk_post_nonrequested.html" %}
  {% endfor %}
  {% if not recipient.notify_new_parent %}
    {% include "notifications/activity/_new_parents.html" %}
  {% endif %}
  {% if not recipient.notify_added_to_village %}
    {% include "notifications/activity/_added_to_villages_nonrequested.html" %}
  {% endif %}
  {% if not recipient.notify_joined_my_village %}
    {% include "notifications/activity/_new_teachers.html" %}
  {% endif %}
</ul>

<p>
--<br />
Don't want email notifications? <a href="{{ profile_url }}">Edit your profile</a>.
</p>
