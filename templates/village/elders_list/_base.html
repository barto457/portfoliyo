{% load elders %}
{% load url from future %}

<div class="village-elders">

  {% with nav_elders|elder_types as elder_types %}
  {% for elder_type in elder_types %}

  <h2 class="elders-title">{% if elder_type.school_staff %}Teachers{% else %}Family Members{% endif %}</h2>

  {% if elder_type.elders %}
  <ul>
    {% for nav_elder in elder_type.elders %}
    <li class="elder" title="{{ nav_elder|elder_status_description:request.user.profile }}">
      <span class="vcard {{ nav_elder|elder_status:request.user.profile }}{% if nav_elder == elder %} active{% endif %}">
        <b class="title">{{ nav_elder.role_in_context }}:</b>
        <span class="fn">{% firstof nav_elder.name nav_elder.user.email nav_elder.phone %}</span>
        {% if nav_elder.name and not nav_elder.user.email %}
          <div class="tel">
            <b class="type">Phone:</b>
            <span class="value">{{ nav_elder.phone }}</span>
          </div>
        {% endif %}
      </span>
      {% if not nav_elder.school_staff %}
        <div class="listitem-actions">
          {% if request.user.profile.school_staff %}
          <a href="{% block edit-elder-url %}{% endblock %}" class="action-edit ajax-link" title="edit {% firstof nav_elder.name nav_elder.user.email nav_elder.phone %}">edit</a>
          {# <button class="action-remove" title="remove {% firstof nav_elder.name nav_elder.user.email nav_elder.phone %}">remove</button> #}
          {% endif %}
          <a href="#" class="action-sms" title="text {% firstof nav_elder.name nav_elder.user.email nav_elder.phone %}" data-name="{% firstof nav_elder.name nav_elder.user.email nav_elder.phone %}">send sms</a>
        </div>
      {% endif %}
    </li>
    {% endfor %}
  </ul>
  {% endif %}

  {% block invite-elder %}
  {% if request.user.profile.school_staff %}
  <a href="{% block invite-elder-url %}{% endblock %}" class="addelder-link ajax-link{% if invite_teacher_active and elder_type.school_staff %} active{% endif %}{% if invite_family_active and not elder_type.school_staff %} active{% endif %}">{% if elder_type.school_staff %}Invite Teacher{% else %}Invite Family Member{% endif %}</a>
  {% endif %}
  {% endblock invite-elder %}

  {% endfor %}
  {% endwith %}
</div>
