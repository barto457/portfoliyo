// ---------------------------------------------------------------------------
// Village Nav

$village-nav-bg       : $base2;
$village-nav-title-bg : $blue;
$village-nav-rhythm   : .25;
$village-nav-action-color : $base03;

%village-nav-span {
  @include bleed($village-bleed, left);
  display: block;
  position: relative;
}

%village-nav-item {
  @extend %village-nav-span;
  @include trailing-border(1px,$village-nav-rhythm,$village-list-size);
  @include padding-leader($village-nav-rhythm,$village-list-size);
  border-color: $village-border-color;
}

.nav-error, .remove-error {
  @extend %error;
  @include bleed($village-bleed, left);
}

.village-nav {
  @extend %village-lists;
  @extend %overflow-y;
  @include box-sizing(content-box);
  left: - $village-bleed;
  width: columns($left);
  padding-left: $village-bleed;
  border: 1px solid $village-border-color;
  border-width: 0 1px;
  z-index: 5;
}

.listitem {
  position: relative;
  &.student, &.group { @include sans; }
}

.listitem-select {
  @extend %village-nav-item;
  #{$link} {
    @extend %village-activenav;
    @include rgba-background(rgba($village-nav-bg,.25));
    .title & {
      @include rgba-background(rgba($village-nav-title-bg,.25));
      font-weight: bold;
      color: $back;
      &.active {
        background: $base1;
        color: $base3;
      }
    }
    .group & {
      @extend %icon;
      @extend %icon-list;
    }
  }
  #{$focus} {
    @include rgba-background(rgba($village-nav-bg,.5));
    .title & {
      @include rgba-background(rgba($village-nav-title-bg,.5));
    }
  }

  .unread {
    @include adjust-font-size-to($smallpx,.75,$village-list-size);
    @include border-radius(.25em);
    @include box-shadow(rgba($back,.5) 0 0 3px inset);
    position: absolute;
    right: $xxxsmallpx;
    top: rhythm(.375,$smallpx);
    padding: 0 .25em;
    background: $accent;
    color: $base3;
    text-align: center;
    &.zero { display: none; }
  }
  &.editing {
    @include mono;
    background: lighten($orange,40);
    min-height: rhythm(1,$village-list-size);
  }
  &.removed {
    @extend %icon;
    @extend %icon-x;
    @include box-shadow($back 0 0 3px inset);
    color: $red;
    background: lighten($red,40);
  }
}

%actions-base {
  @include transition(all 400ms);
  position: absolute !important;
  top: -1px;
  right: 0;
  bottom: 0px;
  padding: rhythm($village-nav-rhythm,$village-list-size);
  padding-right: rhythm(.5,$village-list-size);
  background: $village-nav-action-color;
  color: $back;

  @include opacity(0);
  .listitem:hover &, .removed + &, .editing + & {
    @include opacity(1);
    z-index: 100;
  }
}

.listitem-actions {
  @extend %actions-base;
  @include css-arrow(left, rhythm($village-nav-rhythm,$village-list-size), $village-nav-action-color);

  form { display: inline; }
  a, button {
    @extend %icon-replace;
    @include link(light,true);
    margin-left: rhythm(.5,$village-list-size);
  }
  .action-edit { @extend %icon-pencil; }
  .action-save {
    @extend %icon-checkmark;
    display: none;
  }
  .action-remove { @extend %icon-trashcan; }
  .undo-action-remove { @extend %icon-undo; }
  .action-addbulk { @extend %icon-users; }
  .action-addsingle { @extend %icon-user; }
}

.action-back.groups {
  @extend %icon-replace;
  @extend %icon-list;
  @include leader($village-nav-rhythm);
  @include border-radius(.125em);
  @include rem(width, rhythm(1));
  position: relative;
  overflow: hidden;
  float: left;
  margin-right: .4rem;
  color: $base3;
  background: rgba($back,.5);
  z-index: 6;
  #{$focus} {
    @extend %icon-arrow-left;
    background: $accent;
  }
}

.additem-link {
  @extend %village-nav-item;
  @extend %village-addlink;
  .addgroup & {
    @extend %icon-addlist;
    background: rgba($blue,.25);
    &:before {
      @include adjust-font-size-to($normpx);
      @include rem(margin-left, rhythm(-.18));
    }
  }
}
