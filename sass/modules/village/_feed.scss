// ---------------------------------------------------------------------------
// Village Feed

.village-feed {
  position: relative;
  overflow: hidden;
  height: 100%;
  background: color($base3 lightest);
}

.feed-posts {
  @extend %overflow-y;
  @include calc(height, '100% - #{rhythm(5.125)}');
  padding: rhythm(.5) rhythm(1);
}

// ---------------------------------------------------------------------------
// Getting Started

.feedhead {
  @include serif;
  @include adjust-font-size-to($medpx);
  @include trailer(.5);
}

// ---------------------------------------------------------------------------
// Posts

.post {
  @extend %icon;
  @extend %icon-bubble;
  @include pie-clearfix;
  @include adjust-font-size-to($smallpx);
  @include trailing-border(1px,.75);
  @include trailer(.75);
  border-color: color($base2,.5);

  &:last-child {
    @include trailer(0);
    border: 0;

    .has-instructions & { @include trailer(4); }
  }

  &:before {
    @include adjust-font-size-to($medpx);
    @include border-radius($box-padding);
    @include inset;
    float: left;
    margin-right: rhythm(.5);
    padding: rhythm(.25) rhythm(.5);
    background: $base;
    color: $base3;
    text-align: center;
  }

  &.pending {
    @extend %icon-bubble-dots;
    &:before { background: color($blue dark); }
  }
  &.sms {
    @extend %icon-bubble-forward;
    &:before { background: color($green dark); }
  }
  &.from-sms {
    @extend %icon-bubble-reply;
    &:before { background: color($blue dark); }
  }
  &.no-sms {
    @extend %icon-bubble;
    &:before { background: color($orange dark); }
  }

  .timeout {
    @extend %error;
    @extend %icon;
    @extend %icon-warning;
    @include rhythm-margins(.25);
    @include border-radius($box-padding);
    @include inset;
    clear: both;
    padding: $box-padding rhythm(1);
    &:before { @include adjust-font-size-to($normpx); }
  }
}

.post-header, .post-body {
  padding-left: rhythm(2.5);
}

.byline {
  @extend %ellipsis;
  @include adjust-font-size-to($normpx);
  @include serif;
  font-weight: bold;
  .old & { font-weight: normal; }
}

.pubdate {
  @include cond;
  float: right;
  padding-left: rhythm(1);
  color: $base1;
  font-weight: bold;
  .old & { font-weight: normal; }
}

.recipients {
  @include adjust-font-size-to($xsmallpx);
  @extend %ellipsis;
  padding-right: 50%;
  color: $base1;
}

// ---------------------------------------------------------------------------
// Instructions

.howto {
  @include pie-clearfix;
  @include stretch-x;
  bottom: 100%;
  margin: rhythm(.5) rhythm(1);
}

[class^="howto-"] {
  @include adjust-font-size-to($smallpx);
  @include nth-omega(even);
  @include border-radius($box-padding);
  @include rhythm-borders(2px,.5);
  @include box-shadow($base 0 0 $box-padding);
  @include arrow(bottom center $orange rhythm(.5));
  position: absolute;
  bottom: 0;
  width: columns(floor($center/2),$center);
  border-color: $orange;
  background: $base3;
  text-align: center;
  &:first-child { left: 0; }
  &:last-child { right: 0; }
}

// ---------------------------------------------------------------------------
// Post Add Form

$addnote-fontsize: $input-font-size;
$postaction-size: $smallpx;

%post-targeting {
  @include adjust-font-size-to($postaction-size);
  @include trailer(.5);
  text-align: left;
}

.post-add-form {
  @extend %formdefaults;
  @include pie-clearfix;
  @include box-shadow($base 0 0 $box-padding);
  position: relative;
  padding: rhythm(.5) rhythm(1);
  background: color($base3 lighter);
  border-top: 1px solid $village-border-color;
  text-align: right;
  &.group-posts { background: mix($blue,$base2,25%); }

  .form-actions {
    clear: none;
    margin: 0;
    .action-post {
      @include span-columns(2 omega, $center);
      @include adjust-font-size-to($smallpx);
      height: rhythm(2.5);
      font-weight: bold;
    }
  }

  .sms-targeting {
    @extend %post-targeting;
    > .type {
      display: inline;
      font-weight: bold;
      cursor: default;
    }
    .multiselect-dropdown { min-width: columns(2, $center); }
    .ui-multiselect { width: 100%; }
  }
  .group-targeting {
    @extend %post-targeting;
    @extend %icon;
    @extend %icon-warning;
    font-weight: bold;
  }
}

.post-textfield {
  @include span-columns($center - 2, $center);
  margin: 0;
  .value {
    @include trailer(.125);
    height: rhythm(2.5);
    margin: 0;
    background: rgba(white,.75);
    padding-left: rhythm(.5);
    resize: none;
  }
  .charcount {
    @include adjust-font-size-to($xsmallpx);
    position: absolute;
    right: .25em;
    bottom: 0;
    color: $base1;
    &.overlimit { color: $red; }
  }
}

// ---------------------------------------------------------------------------
// Errors

.feed-error {
  @extend %error;
  padding: rhythm(1);
}
