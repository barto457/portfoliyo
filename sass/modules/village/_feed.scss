// ---------------------------------------------------------------------------
// Village Feed

.village-feed {
  @extend %overflow-y;
  left: 0;
  right: 0;
  bottom: rhythm(3.5);
}

$post-byline-cols : 2;
$post-size        : $smallpx;
$post-time-size   : $xsmallpx;
$post-v-padding   : .25;
$post-h-padding   : gutter($center);

.post {
  @include pie-clearfix;
  @include adjust-font-size-to($post-size);
  @include trailing-border(1px, $post-v-padding, $post-size);
  padding-left: $post-h-padding;
  padding-right: $post-h-padding;
  border-color: $base1;

  .old + &:before {
    @include bleed($post-h-padding);
    @include padding-leader(.25,$post-size);
    @include padding-trailer(.25,$post-size);
    @include text-shadow($back 0 -1px 0);
    content: "new posts â–¼";
    display: block;
    background: $base;
    color: $base3;
    text-align: center;
    text-transform: uppercase;
  }
  &.mine { background: lighten($blue,45); }
  &.not-posted { background: lighten($red,45); }

  &.old {
    .title, .summary, .post-text { color: $base1; }
    &.mine { @include rgba-background(rgba(lighten($blue,45),.5)); }
    .old + &:before { display: none; }
  }

  .timeout {
    @extend %error;
    @include bleed($post-h-padding);
  }
}

.post-meta {
  @include pie-clearfix;
  position: relative;
  color: $base1;

  .byline, .pubdate {
    @include ellipsis;
    max-width: 45%;
  }
  .byline { float: left; }
  .title {
    color: $base;
    font-weight: bold;
  }
  .pubdate {
    @include adjust-font-size-to($post-time-size, 1, $post-size);
    @include cond;
    float: right;
    text-align: right;
  }
}

.sms-info {
  .summary {
    @extend %icon-replace;
    float: left;
    margin-right: .2em;
    .sms & { @extend %icon-phone; }
    .no-sms & { @extend %icon-no-phone; }
  }

  .details-body {
    @include bleed($post-h-padding);
    @include trailer($post-v-padding);
    @include css-arrow(bottom, .375em, $back);
    display: none;
    background: $back;
    &:after { left: $post-h-padding; margin-left: 0; }
  }
}

.post-text { @include clearfix; }

.nametag {
  @include border-radius(4px);
  @include rgba-background(rgba($base1,.25));
  display: inline-block;
  padding: 0 .4em;
  border: 1px solid $base01;
  &.me {
    background: $blue;
    color: $base3;
  }
}

.getting-started {
  @extend %type;
  @include padding-leader;
  @include trailing-border(1px, 1);
  padding-left: $post-h-padding;
  padding-right: $post-h-padding;
  border-color: $base1;
  background: lighten($base3,10);
  h2 {
    @include adjust-font-size-to($largepx);
    @include trailer(1,$largepx);
  }
  li { @include padding-trailer(.25); }
  :last-child { margin-bottom: 0; }
  .mobile {
    @extend %icon-replace;
    @extend %icon-phone;
    display: inline-block;
  }
}

// ---------------------------------------------------------------------------
// Note Add Form

$addnote-fontsize: $input-font-size;

.post-add-form {
  @extend %formdefaults;
  @include stretch-x;
  bottom: 0;
  padding: rhythm(.5) gutter();
  border-top: 1px solid $base;
  background: $base1;

  .formfield {
    float: left;
    width: columns($center - 2, $center);
    margin: 0;
  }
  textarea {
    height: rhythm(2.5, $addnote-fontsize);
    min-height: rhythm(2.5, $addnote-fontsize);
    background: rgba(white,.75);
    padding-left: rhythm(.5, $addnote-fontsize);
    resize: none;
    .lt-ie9 & { min-height: rhythm(2.5 - $input-rhythm*2, $addnote-fontsize); }
  }
  .charcount {
    @include adjust-font-size-to($xsmallpx);
    position: absolute;
    right: .25em;
    bottom: 0;
    color: $base1;
    &.overlimit { color: $red; }
  }

  .form-actions {
    clear: none;
    float: right;
    margin: 0;
    width: space(2,$center);
  }
  button {
    @include border-left-radius(0);
    position: relative;
    top: 1px;
    padding: 0;
    height: rhythm(2.5);
    width: 100%;
    text-transform: uppercase;
  }
}

// ---------------------------------------------------------------------------
// Errors

%error {
  background: $red;
  color: $base3;
  a {
    #{$link} { color: mix($base3, $alt, 65%); }
    #{$focus} { color: mix($base3, $accent, 65%); }
  }
}

.feed-error {
  @extend %error;
  padding: rhythm(1);
}
